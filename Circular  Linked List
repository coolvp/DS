#include <iostream.h>
#include <stdlib.h>
#include<conio.h>

struct node
{
    int data;
    struct node *next;
} *first, *list, *newnode, *last;

void create()
{
    int e;
    first = NULL;
    cout << "\nEnter the no(-99 to exit):";
    cin >> e;

    do
    {
	newnode = (struct node *)malloc(sizeof(struct node));
	newnode->data = e;
	newnode->next = NULL;

	if (first == NULL)
	{
	    first = newnode;
	}
	else
	{
	    last->next = newnode;
	}
	last = newnode;

	cout << "\nEnter the no(-99 to exit):";
	cin >> e;

    } while (e != -99);

    last->next = first;
}

void addbeg()
{
    int e;
    cout << "\nEnter no:";
    cin >> e;

    newnode = (struct node *)malloc(sizeof(struct node));
    newnode->data = e;
    newnode->next = first;
    first = newnode;
    last->next = first;
}

void addmid()
{
    int e, p, i;
    cout << "\nEnter the position:";
    cin >> p;
    cout << "\nenter the no:";
    cin >> e;

    newnode = (struct node *)malloc(sizeof(struct node));
    newnode->data = e;
    newnode->next = NULL;

    if (p == 1)
    {
	newnode->next = first;
	first = newnode;
	last->next = first;
    }
    else
    {
	list = first;
	for (i = 1; i <= p - 2 && list->next != first; i++)
	{
	    list = list->next;
	}
	newnode->next = list->next;
	list->next = newnode;

	if (newnode->next == first)
	{
	    last = newnode;
	}
    }
}

void addend()
{
    int e;
    cout << "\nEnter the no:";
    cin >> e;

    newnode = (struct node *)malloc(sizeof(struct node));
    newnode->data = e;

    list = first;
    while (list->next != first)
    {
	list = list->next;
    }
    newnode->next = list->next;
    list->next = newnode;

    if (newnode->next == first)
    {
	last = newnode;
    }
}

void delbeg()
{
    if (first == last)
    {
	cout << "\nlinklist is empty";
    }
    else
    {
	last->next = first->next;
	first = first->next;
	cout << "\nFirst node is deleted";
    }
}

void delmid()
{
    int i, p;
    cout << "\nEnter position:";
    cin >> p;

    list = first;

    if (list == last)
    {
	cout << "\nLinklist is empty";
    }
    else
    {
	for (i = 1; i <= p - 2 && list->next->next != first; i++)
	{
	    list = list->next;
	}

	if (list->next->next == first)
	{
	    cout << " Out of order";
	}
	else
	{
	    list->next = list->next->next;
	    cout << "\nnode:- " << p << " is deleted";
	}
    }
}

void delend()
{
    if (first == last)
    {
	cout << "\nLinklist is empty";
    }
    else
    {
	list = first;
	while (list->next->next != first)
	{
	    list = list->next;
	}
	list->next = first;
	cout << "\nLast node is deleted";
    }
}

void disp()
{
    if (first == last)
    {
	cout << "\nLinklist is empty";
    }
    else
    {
	list = first;
	do
	{
	    cout << "\t " << list->data;
	    list = list->next;
	} while (list != first);
    }
}

int main()
{
    int ch;
    do
    {
	clrscr();
	cout << "\n1:Create the linked list";
	cout << "\n2:Insert at 1st position";
	cout << "\n3:Insert at any position";
	cout << "\n4:Insert at the last position";
	cout << "\n5:Delete from 1st position";
	cout << "\n6:Delete from any position";
	cout << "\n7:Delete from the last position";
	cout << "\n8:Display linked list";
	cout << "\n9:Exit";
	cout << "\nEnter your choice:";
	cin >> ch;

	switch (ch)
	{
	case 1:
	    create();
	    break;
	case 2:
	    addbeg();
	    break;
	case 3:
	    addmid();
	    break;
	case 4:
	    addend();
	    break;
	case 5:
	    delbeg();
	    break;
	case 6:
	    delmid();
	    break;
	case 7:
	    delend();
	    break;
	case 8:
	    disp();
	    break;
	case 9:
	    break;
	}
    getch();
    } while (ch != 9);

    return 0;
}
